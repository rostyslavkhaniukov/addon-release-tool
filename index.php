<?php
declare(strict_types=1);

require_once __DIR__ . '/vendor/autoload.php';

use AirSlate\Releaser\Builder;
use AirSlate\Releaser\Client;
use AirSlate\Releaser\FileProcessor;

$client = new Client([
    'owner' => 'airslateinc',
    'token' => '1cb165f4f3295a288476aa7ae8aa9657c96d1d0a',
]);

$addons = [
    'prefill-from-source-addons',
];

foreach ($addons as $addon) {
    (new Builder($client, 'airslateinc', $addon))
        ->from('master')
        ->branch('ADD-3522-update-php-image')
        ->step(function (FileProcessor $file) {
            return $file
                ->take('Dockerfile')
                ->replace(
                    '/(pdffiller\/php7[12]-ubuntu16:v)\d+\.\d+\.\d+/',
                    '${1}1.2.0'
                );
        })
        ->commit('[ADD-3522] Update base docker image')
        ->push()
        ->makePR('[ADD-3522] Update base docker image', 'Autogenerated PR');
}
